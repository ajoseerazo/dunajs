<html>
  <head>
    <script src="./duna.js"></script>
  </head>

  <body>
    <!--<h1 id="h1">
      <span><span>Hola</span><span> { text }</span></span>
      <button @click="onClick">{ buttonText }</button>
      <b>{ text }</b>
      <p>{ buttonText.toLowerCase() }</p>
      <div>{ value }</div>
      <input @changeValue="changeInput" @value="value" />
    </h1>-->

    <button id="button-1" @click="onClick">{ buttonText }</button>

    <input id="input-1" @value="value" />

    <h1>Todo App</h1>

    <div id="todo-app">
      <!--<div>{ tasks.map(task => task) }</div>-->

      <div @each="task in tasks">
        <li @click="clickOnTask">
          <input
            type="checkbox"
            @checked="{task.done}"
            @change="onChangeTaskCheckbox"
          />
          <span>{ value }: { task.title }</span>
        </li>
      </div>

      <input @changeValue="changeInput" @value="value" />

      <button @click="addTask" style="margin-top: 20px">
        <span>{ buttonText }</span>
      </button>

      {value}
    </div>

    <br />
    <br />
    <br />
    <br />

    <div id="reactive">
      <button @click="handleClick">Count: {count}</button>

      <p>{count} * 2 = {doubled}</p>
      <p><span>{doubled}</span> * 2 = <span>{quadrupled}</span></p>
    </div>
    <!--<div id="greetings">
      <h1>El texto es: { text.toLowerCase() }</h1>
      <button @click="onClick">{ buttonText }</button>
    </div>

    <div id="text-example" @text="text"></div>

    <input id="input" @changeValue="onChange" @value="value" />
    <button id="button" @click="onClick">{ buttonText }</button>

    <br />
    <br />
    <br />

    <button id="button-2" @click="onClick">
      Clicked { count } { count === 1 ? 'time' : 'times' }
    </button>

    <script>
      // Greetings Component
      const greeting = new Duna({
        state: {
          text: "Hello World!",
          buttonText: "testing",
        },
        events: {
          onClick: function () {
            this.state.text = "Hola que tal?";
            this.state.buttonText = "Que más pues?";
          },
        },
      });
      greeting.mount("#greetings");

      const text = new Duna({
        state: {
          text: "<h1>This is the text</h1>",
        },
      });
      text.mount("#text-example");

      // Button Component
      const button = new Duna({
        state: {
          buttonText: "Hola",
        },
        events: {
          onClick: function () {
            this.state.buttonText = "Que más pues?";
            greeting.state.text = input.state.value;
          },
        },
      });
      button.mount("#button");

      // Input Component
      const input = new Duna({
        events: {
          onChange: function (e) {
            input.state.value = e.target.value;
          },
        },
        state: {
          value: "Amilcar",
        },
      });
      input.mount("#input");

      const button2 = new Duna({
        state: {
          count: 0,
        },
        events: {
          onClick: function () {
            this.state.count += 1;
          },
        },
      });
      button2.mount("#button-2");
    </script>-->

    <script>
      const todo = new Duna({
        state: {
          tasks: [
            {
              title: "This is the first task",
              done: true,
            },
            {
              title: "This is another task",
              done: false,
            },
          ],
          value: "Hello",
          buttonText: "Add new task",
        },
        events: {
          addTask() {
            if (this.state.value) {
              console.log("Input State", this.state.value);
              this.state.tasks = this.state.tasks.concat([
                {
                  title: this.state.value,
                },
              ]);
              this.state.value = "";
              this.state.buttonText = "Add other task";
            }
          },
          changeInput(value) {
            this.state.value = value;
          },
          clickOnTask(index) {
            console.log(this.state.tasks[index]);
          },
          onChangeTaskCheckbox(checked, index) {
            const newTaks = [];
            for (let i = 0; i < this.state.tasks.length; i++) {
              if (i !== 1) {
                newTaks.push(this.state.tasks[i]);
              } else {
                newTaks.push({
                  ...this.state.tasks[i],
                  done: true,
                });
              }
            }

            console.log("New Tasks", newTaks);

            this.state.tasks = newTaks;

            console.log(this.state);
          },
        },
      });

      todo.mount("#todo-app");
    </script>

    <script>
      const input = new Duna({
        state: {
          value: "Super value",
        },
      });
      input.mount("#input-1");

      const button = new Duna({
        state: {
          buttonText: "Click on me!",
        },
        events: {
          onClick() {
            this.state.buttonText = "Clicked";
            input.state.value = "Puta";
          },
        },
      });
      button.mount("#button-1");
    </script>

    <script>
      const reactive = new Duna({
        state: {
          count: 1,
          doubled: 2,
          quadrupled: 4,
        },
        events: {
          handleClick() {
            this.state.count += 1;
            this.state.doubled = this.state.count * 2;
            this.state.quadrupled = this.state.doubled * 2;
          },
        },
      });
      reactive.mount("#reactive");
    </script>

    <!--<script>
      const h1 = new Duna({
        state: {
          text: "Hola!",
          buttonText: "Click Me!",
          value: "",
        },
        events: {
          onClick() {
            alert("Mamalo");
          },
          changeInput(value) {
            this.state.value = value;
          },
        },
      });
      h1.mount("#h1");

      const button1 = new Duna({
        events: {
          onClick() {
            h1.state.text = `Como estas ${h1.state.value}?`;
            h1.state.buttonText = "Fuck";
          },
        },
      });
      button1.mount("#button-1");
    </script>-->
  </body>
</html>
